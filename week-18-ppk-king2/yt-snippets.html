<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Week 18 — YouTube Snippets Player</title>
  <style>
    :root{
      --bg:#f7fbff; --card:#fff; --accent:#0ea5e9; --muted:#475569; --radius:12px; --text:#0f172a;
    }
    html,body{height:100%;margin:0;}
    body{
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
      background:var(--bg); color:var(--text); padding:18px; box-sizing:border-box;
    }
    .wrap{max-width:980px;margin:0 auto;}
    header{text-align:center;margin-bottom:12px;}
    h1{font-size:32px;margin:6px 0;color:var(--accent);}
    p.sub{color:var(--muted);margin:0 0 14px;}
    .player-box{background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 10px 30px rgba(2,6,23,0.06);}
    .video-wrap{position:relative;width:100%;padding-top:56.25%;border-radius:10px;overflow:hidden;background:#000;}
    #player{position:absolute;left:0;top:0;width:100%;height:100%;}
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;align-items:center;justify-content:center;}
    button{border:0;background:var(--accent);color:#fff;padding:12px 16px;border-radius:10px;font-weight:700;font-size:16px;cursor:pointer;}
    button.secondary{background:#64748b;}
    .clip-list{margin-top:14px;display:grid;gap:8px;}
    .clip{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-radius:10px;background:#fbfdff;border:1px solid #e6eef8;}
    .clip .meta{font-size:15px;}
    .clip button{padding:8px 12px;font-size:14px;cursor:pointer;border-radius:8px;border:0;background:#0ea5e9;color:#fff;}
    .muted-time{color:var(--muted);font-size:13px;margin-top:4px;}
    footer{text-align:center;margin-top:14px;color:var(--muted);font-size:13px;}
    @media (max-width:640px){ h1{font-size:26px;} button{font-size:15px;padding:10px 12px;} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Week 18 — YouTube Snippets</h1>
      <p class="sub">Four clipped segments (auto-advance). Press <strong>Play All</strong> to run them in sequence or jump to any clip.</p>
    </header>

    <div class="player-box" role="region" aria-label="YouTube snippets player">
      <div class="video-wrap">
        <div id="player"></div>
      </div>

      <div class="controls" role="toolbar" aria-label="player controls">
        <button id="playAll">Play All</button>
        <button id="prev" class="secondary">◀ Prev</button>
        <button id="next" class="secondary">Next ▶</button>
        <button id="pause" class="secondary">Pause</button>
        <button id="stop" class="secondary">Stop</button>
      </div>

      <div class="clip-list" id="clipList" aria-live="polite"></div>
    </div>

    <footer>
      <a href="index.html" style="color:inherit;text-decoration:none;">◀ Back to Week 18 index</a>
      <div style="margin-top:6px;color:var(--muted);font-size:12px;">If a clip errors on the live page, the uploader may have disabled embedding — in that case use an unlisted upload or a different source.</div>
    </footer>
  </div>

  <script>
/* ========== CLIP CONFIG ========== */
const clips = [
  // Clip 1: bU2-E0TIDx4 58:58 → 1:22:20  (3538 → 4940)
  { id: 'bU2-E0TIDx4', title: 'Clip 1', start: 3538, end: 4940 },

  // Clip 2: PEj2Jv1tXxk 1:05:59 → 1:14:22 (3959 → 4462)
  { id: 'PEj2Jv1tXxk', title: 'Clip 2', start: 3959, end: 4462 },

  // Clip 3: bU2-E0TIDx4 1:22:20 → 1:38:39 (4940 → 5919)
  { id: 'bU2-E0TIDx4', title: 'Clip 3', start: 4940, end: 5919 },

  // Clip 4: PEj2Jv1tXxk 1:16:37 → 1:31:16 (4597 → 5476)
  { id: 'PEj2Jv1tXxk', title: 'Clip 4', start: 4597, end: 5476 }
];
/* ================================ */

let player = null;
let currentIndex = 0;
let pollTimer = null;

function formatTime(s) {
  const h = Math.floor(s / 3600); s %= 3600;
  const m = Math.floor(s / 60); const sec = s % 60;
  return (h ? h + ':' : '') + String(m).padStart(h ? 2 : 1, '0') + ':' + String(sec).padStart(2, '0');
}

function createUI() {
  const el = document.getElementById('clipList');
  clips.forEach((c, i) => {
    const div = document.createElement('div');
    div.className = 'clip';
    div.id = 'clip-' + i;
    div.innerHTML = `<div class="meta"><strong>${c.title}</strong><div class="muted-time">${formatTime(c.start)} → ${formatTime(c.end)}</div></div>
                     <div><button data-i="${i}" class="jump">Play</button></div>`;
    el.appendChild(div);
  });
}

/* Load YouTube IFrame API */
(function loadYT(){
  const s = document.createElement('script');
  s.src = "https://www.youtube.com/iframe_api";
  document.head.appendChild(s);
})();

/* Called by YouTube's API once ready */
function onYouTubeIframeAPIReady() {
  player = new YT.Player('player', {
    width: '100%', height: '100%',
    playerVars: { rel: 0, modestbranding: 1, controls: 1 },
    events: { onReady: onReady, onStateChange: onStateChange }
  });
}

function onReady() {
  document.getElementById('playAll').onclick = () => { playClip(0); };
  document.getElementById('next').onclick = () => { playClip(currentIndex + 1); };
  document.getElementById('prev').onclick = () => { playClip(currentIndex - 1); };
  document.getElementById('pause').onclick = () => { if (player) { player.pauseVideo(); stopPoll(); } };
  document.getElementById('stop').onclick = () => { if (player) { player.stopVideo(); } stopPoll(); currentIndex = 0; highlight(); };

  document.querySelectorAll('.jump').forEach(btn => {
    btn.onclick = (e) => {
      const i = +e.currentTarget.dataset.i;
      playClip(i);
    };
  });
}

function playClip(i) {
  if (i < 0) i = 0;
  if (i >= clips.length) { if (player) player.stopVideo(); stopPoll(); currentIndex = 0; highlight(); return; }
  currentIndex = i;
  highlight();
  const c = clips[i];
  if (!player) return;
  player.loadVideoById({ videoId: c.id, startSeconds: c.start, endSeconds: c.end, suggestedQuality: 'large' });
  startPoll();
}

function startPoll() {
  stopPoll();
  pollTimer = setInterval(() => {
    if (!player) return;
    const state = player.getPlayerState();
    if (state !== YT.PlayerState.PLAYING) return;
    const t = player.getCurrentTime();
    const c = clips[currentIndex];
    if (t >= (c.end - 0.35)) {
      playClip(currentIndex + 1);
    }
  }, 300);
}
function stopPoll() { if (pollTimer) { clearInterval(pollTimer); pollTimer = null; } }

function onStateChange(e) {
  if (e.data === YT.PlayerState.ENDED) {
    playClip(currentIndex + 1);
  } else if (e.data === YT.PlayerState.PAUSED) {
    stopPoll();
  }
}

function highlight() {
  document.querySelectorAll('.clip').forEach((el, idx) => el.classList.toggle('active', idx === currentIndex));
}

/* initialize UI */
createUI();
</script>
</body>
</html>
